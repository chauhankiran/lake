<%- include("shared/header") %>

<div class="container my-4">
  <div class="row">
    <div class="col-md-12">
      <%- include("shared/flash") %>
      
      <h1 class="mb-3">New issue</h1>

      <form action="/issues" method="post" class="needs-validation row" novalidate>
        <!-- Left side -->
        <div class="col-md-8">
          
          <!-- Project -->
          <div class="mb-3">
            <label for="projectId">Project</label>
            <select name="projectId" id="projectId" class="form-select" required>
              <% projects.forEach(function (project) { %>
                <% if (project.id == projectId ) { %>
                  <option value="<%= project.id %>" selected><%= project.name %></option>
                <% } else {  %>
                  <option value="<%= project.id %>"><%= project.name %></option>
                <% } %>
              <% }) %>
            </select>
            <div class="invalid-feedback">
              Please select project.
            </div>
          </div>
          
          <!-- Title -->
          <div class="mb-3">
            <label for="title">Title</label>
            <input type="text" name="title" id="title" class="form-control" placeholder="Login is not working on home page" required>
            <div class="invalid-feedback">
              Title is required.
            </div>
          </div>

          <!-- Description -->
          <div class="mb-3">
            <label for="description">Description</label>
            <textarea name="description" id="description" cols="30" rows="10" class="form-control" placeholder="Optional description of the issue"></textarea>
          </div>

          <!-- Submit button -->
          <div class="mb-3">
            <button type="submit" class="btn btn-primary">Create issue</button>
          </div>
        </div>

        <!-- Right side -->
        <div class="col-md-4">

          <!-- Type -->
          <div class="mb-3">
            <label for="typeId">Type</label>
            <select name="typeId" id="typeId" class="form-select" required>
              <% types.forEach(function (type) { %>
                <option value="<%= type.id %>"><%= type.name %></option>
              <% }) %>
            </select>
            <div class="invalid-feedback">
              Please select type.
            </div>
          </div>

          <!-- Status -->
          <div class="mb-3">
            <label for="statusId">Status</label>
            <select name="statusId" id="statusId" class="form-select" required>
              <% statuses.forEach(function (status) { %>
                <option value="<%= status.id %>"><%= status.name %></option>
              <% }) %>
            </select>
            <div class="invalid-feedback">
              Please select status.
            </div>
          </div>

          <!-- Priority -->
          <div class="mb-3">
            <label for="priorityId">Priority</label>
            <select name="priorityId" id="priorityId" class="form-select" required>
              <% priorities.forEach(function (priority) { %>
                <option value="<%= priority.id %>"><%= priority.name %></option>
              <% }) %>
            </select>
            <div class="invalid-feedback">
              Please select priority.
            </div>
          </div>

          <!-- Assignee -->
          <div class="mb-3">
            <label for="assigneeId">Assignee</label>
            <select name="assigneeId" id="assigneeId" class="form-select" required>
              <% users.forEach(function (user) { %>
                <option value="<%= user.id %>"><%= user.firstName %></option>
              <% }) %>
            </select>
          </div>

          <!-- Due date -->
          <div class="mb-3">
            <label for="dueDate">Due date</label>
            <input type="date" name="dueDate" id="dueDate" class="form-control">
          </div>

          <!-- Estimation -->
          <div class="mb-3">
            <label for="estimation">Estimation</label>
            <input type="text" name="estimation" id="estimation" class="form-control">
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include("shared/footer") %>
